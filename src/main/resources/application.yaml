server:
  port: 8582

management:
  endpoints:
    web:
      exposure:
        include: '*'
      base-path: /
  endpoint:
    health:
      show-details: always

spring:
  application:
    name: Bulk Scan Orchestrator

azure:
  servicebus:
    envelopes:
      connection-string: ${ENVELOPES_QUEUE_CONNECTION_STRING}
      queue-name: envelopes
      max-delivery-count: ${ENVELOPES_QUEUE_MAX_DELIVERY_COUNT}
    processed-envelopes:
      connection-string: ${PROCESSED_ENVELOPES_QUEUE_CONNECTION_STRING}
      queue-name: processed-envelopes
    payments:
      connection-string: ${PAYMENTS_QUEUE_CONNECTION_STRING}
      queue-name: payments

core_case_data:
  api:
    url: 'http://localhost:4452'

document_management:
  url: ${DOCUMENT_MANAGEMENT_URL:http://localhost:4460}
  context-path: documents

idam:
  s2s-auth:
    url:    ${S2S_URL:http://localhost:4552}
    secret: ${S2S_SECRET:AAAAAAAAAAAAAAAA}
    name:   ${S2S_NAME:bulk_scan_orchestrator}
  api:
    url: http://localhost:8080
  client:
    id: 'bsp'
    secret: ${IDAM_CLIENT_SECRET:123456}
    redirect_uri: http://localhost/receiver
  users:
    bulkscan:
      username: ${IDAM_USERS_BULKSCAN_USERNAME:bulkscan+ccd@gmail.com}
      password: ${IDAM_USERS_BULKSCAN_PASSWORD:Password12}

service-config:
  # Services and all their case type IDs, excluding exception records.
  # These mappings are used by Bulk Scan to determine which case type IDs to search across
  # when looking for a case by its legacy ID. Those CTIDs that are not present here, will
  # not be included in the search.
  services:
    - service: bulkscan # service name corresponds to the name of the container in Blob Storage
      jurisdiction: BULKSCAN
      transformation-url: ${TRANSFORMATION_URL_BULKSCAN}
      case-type-ids:
        - Bulk_Scanned

    - service: sscs
      jurisdiction: SSCS
      case-type-ids: []

    - service: probate
      jurisdiction: PROBATE
      transformation-url: ${TRANSFORMATION_URL_PROBATE}
      case-type-ids: []

    - service: divorce
      jurisdiction: DIVORCE
      case-type-ids: []

    - service: finrem
      jurisdiction: DIVORCE
      case-type-ids: []

    - service: cmc
      jurisdiction: CMC
      case-type-ids:
        - MoneyClaimCase

scheduling:
  task:
    delete-envelopes-dlq-messages:
      enabled: ${DELETE_ENVELOPES_DLQ_MESSAGES_ENABLED:false}
      cron: ${DELETE_ENVELOPES_DLQ_MESSAGES_CRON}
      ttl: ${DELETE_ENVELOPES_DLQ_MESSAGES_TTL}

hystrix:
  command:
    default:
      execution.timeout.enabled: false
      fallback.enabled: true
      circuitBreaker.enabled: true
    check-jurisdiction-log-in:
      circuitBreaker:
        requestVolumeThreshold: 1
        sleepWindowInMilliseconds: 300000 # pause processing for 5 minutes if IDAM rejects log-in attempts
        errorThresholdPercentage: 1

task:
  check-jurisdiction-log-in:
    check-validity-duration: PT5M # only ensure this often that no log-in attempt is rejected by IDAM

feign:
  client:
    config:
      core-case-data-api:
        loggerLevel: ${CCD_LOG_LEVEL:none}

logging:
  level:
    ROOT: DEBUG
